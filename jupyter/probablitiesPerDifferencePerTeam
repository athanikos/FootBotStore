import pandas as pd 
import numpy as np
import matplotlib.pyplot as plt
from pymongo import MongoClient
client = MongoClient("localhost", 27017, maxPoolSize=50)
db = client.book

matches = db['FullTimeMatches']
cursorMatches = matches.find()

teams  = db['Teams']
cursorTeams = teams.find()

dfm =  pd.DataFrame(list(cursorMatches))
dfm =  dfm[dfm.league_name == 'Eredivisie'  ]

dft  =  pd.DataFrame(list(cursorTeams))
dft =  dft[dft.league_name == 'Eredivisie'  ]

for index, row in dft.iterrows():
    teamdata = dfm[ (dfm.hometeamname == row.teamName) & (dfm.differenceAt75 == -1) ]
    print(row.teamName )
    print(    str(     len(teamdata[teamdata.goalScoredLast15 == 1 ])  /  len(teamdata)  ))
